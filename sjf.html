<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SJF</title>
    <link rel="stylesheet" href="./css/mainstyle.css">

</head>
<body>
    <div class="container">
        <div class="title">
          <h1 class="up">Non-Preemptive</h1>
          <h1 class="down">Shortest Job First (SJF)</h1>
        </div>
    
        <div class="content-container">
          <div class="button-container">
            <button id="addRow" class="button add">Add Process</button>
            <button id="calculate" class="button">Calculate</button>
            <button id="resetTable" class="button reset">Reset</button>
          </div>
    
          <table id="dataTable">
            <thead>
              <tr>
                <th>Process ID</th>
                <th>Arrival Time (AT)</th>
                <th>Burst Time (BT)</th>
                <th>End Time (ET)</th>
                <th>Turnaround Time (TT)</th>
                <th>Waiting Time (WT)</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>1</td>
                <td><input type="number" class="arrivalTime" placeholder="AT" min="0" /></td>
                <td><input type="number" class="burstTime" placeholder="BT" min="0" /></td>
                <td class="endTime">-</td>
                <td class="turnaroundTime">-</td>
                <td class="waitingTime">-</td>
                <td><button class="button remove" onclick="removeRow(this)">Remove</button></td>
              </tr>
            </tbody>
          </table>
          <div class="gantt chart">
            <h2>Gantt Chart</h2>
          </div>
          <div class="formulas-container">
            <div class="section">
              <p class="tooltip">CPU Utilization</p>
              <p id="cpuUtilizationFormula" class="formula">
                (<span id="cpuBusy">Sum (BT)</span> / <span id="totalTime">Total End Time</span>) Ã— 100 = <span id="cpuUtilizationResult" class="highlight">0%</span>
              </p>
            </div>
        
            <div class="section">
              <p class="tooltip">Average Turnaround Time</p>
              <p id="attFormula" class="formula">
                <span id="totalTurnaroundTime">Total TT</span> / <span id="totalProcessesTT">Process</span> = <span id="attResult" class="highlight">0</span>
              </p>
            </div>
        
            <div class="section">
              <p class="tooltip">Average Waiting Time</p>
              <p id="awtFormula" class="formula">
                <span id="totalWaitingTime">Total WT</span> / <span id="totalProcessesWT">Process</span> = <span id="awtResult" class="highlight">0</span>
              </p>
            </div>
        </div>
    </div>

    <script>
        document.getElementById('addRow').addEventListener('click', addRow);
        const resetTableButton = document.getElementById('resetTable');
        let processCounter = 2; // Initialize Process ID as 2 since the first one is pre-filled

        // Function to add a new row to the table
        function addRow() {
            const table = document.getElementById('dataTable').getElementsByTagName('tbody')[0];
            
            // Create a new row
            const newRow = table.insertRow(table.rows.length);
            
            // Add HTML for new row with incremented Process ID and inputs for Arrival Time and Burst Time
            newRow.innerHTML = `
                <td>${processCounter}</td>
                <td><input type="number" class="arrivalTime" placeholder="AT" min="0"></td>
                <td><input type="number" class="burstTime" placeholder="BT" min="0"></td>
                <td class="endTime">-</td>
                <td class="turnaroundTime">-</td>
                <td class="waitingTime">-</td>
                <td><button class="button remove" onclick="removeRow(this)">Remove</button></td>
            `;
            
            processCounter++; // Increment the Process ID counter
        }

        // Function to remove a row from the table
        function removeRow(button) {
            const row = button.closest('tr');
            row.remove();
            
            // Update Process IDs after removal
            updateProcessIds();
        }

        // Function to update Process IDs after removal
        function updateProcessIds() {
            const rows = document.getElementById('dataTable').getElementsByTagName('tr');
            let counter = 1;
            
            for (let row of rows) {
                const cells = row.getElementsByTagName('td');
                if (cells.length > 0) { // Skip the header row
                    cells[0].textContent = counter; // Update Process ID
                    counter++;
                }
            }
        }

        
    resetTableButton.addEventListener('click', () => {
    const tableBody = document.getElementById('dataTable').getElementsByTagName('tbody')[0];
    const rows = tableBody.querySelectorAll('tr');
    
    // Remove all dynamic rows except the first one (the header)
    rows.forEach((row, index) => {
        if (index !== 0) {  // Skip the first row
            row.remove();   // Remove dynamic rows
        }
    });

    processCounter = 2;

    // Reset first row (pre-filled)
    const firstRowCells = rows[0].querySelectorAll('td');
    firstRowCells[1].innerHTML = '<input type="number" class="arrivalTime" placeholder="AT" min="0">';
    firstRowCells[2].innerHTML = '<input type="number" class="burstTime" placeholder="BT" min="0">';
    ["3", "4", "5"].forEach(i => (firstRowCells[i].textContent = "-"));

    // Hide result headers and columns
    document.querySelectorAll('.result-header').forEach(header => header.classList.add('hidden'));
    document.querySelectorAll('.result').forEach(cell => cell.classList.add('hidden'));

    // Reset CPU, AWT, ATT values to default
    document.getElementById("totalTurnaroundTime").textContent = "Total TT";
    document.getElementById("totalProcessesTT").textContent = "Processes";
    document.getElementById("attResult").textContent = " 0";

    document.getElementById("totalWaitingTime").textContent = "Total WT";
    document.getElementById("totalProcessesWT").textContent = "processes";
    document.getElementById("awtResult").textContent = " 0";

    document.getElementById("cpuBusy").textContent = "Sum (BT)";
    document.getElementById("totalTime").textContent = "Total End Time";
    document.getElementById("cpuUtilizationResult").textContent = " 0%";
});

    </script>
</body>
</html>